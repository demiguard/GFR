{% extends 'main_page/base.html' %}

{% load static %}
{% load bootstrap4 %}

{% block head %}
  <link rel="stylesheet" type="text/css" href="{% static 'main_page/css/search.css' %}">
{% endblock %}

{% block content %}
  <div>
    <form>
      <div class="form-row">
        <!-- First row of fields -->
        <div class="form-group col-md-2">
          {{ search_form.name.label }}:
          {{ search_form.name }}
        </div>
        <div class="form-group col-md-2">
          {{ search_form.cpr.label }}:
          {{ search_form.cpr }}
        </div>
        <div class="form-group col-md-2">
          {{ search_form.accession_number.label }}:
          {{ search_form.accession_number }}
        </div>
      </div>
      <!-- Second row of fields -->
      <div class="form-row">
        <div class="form-group col-md-2">
          {{ search_form.from_date.label }}:
          {{ search_form.from_date }}
        </div>
        <div class="form-group col-md-2">
          {{ search_form.to_date.label }}:
          {{ search_form.to_date }}
        </div>
      </div>

      <div id="ss-wrapper">
        {% buttons %}
          <input type="button" name="search" value="Søg" id="search-btn">
        {% endbuttons %}
    
        <div id="loader"></div> <!-- Spinner animation -->
      </div>
    </form>
  </div>

  <br>
  <h2>Søgeresultater:</h2>
  <div id="error-message-container">

  </div>
  <table class="table table-hover" id="result_table">
    <thead>
      <tr>
        <th onclick="sort_table(0,'result_table')">Navn</th>
        <th onclick="sort_table(1,'result_table')">Cpr-nr.</th>
        <th onclick="sort_table(2,'result_table')">undersøgelsesdato</th>
        <th onclick="sort_table(3,'result_table')">Accessionnr</th>
        <th></th> <!-- Empty column for action buttons -->
      </tr>
    </thead>
    <tbody id="search-table-body">

    </tbody>
  </table>

  <!-- Display error message when unable to create new study from historical -->
  <div class="modal fade" id="newFailedModal" tabindex="-1" role="dialog" aria-labelledby="newFailedModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          </span> Fejl</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
            <p>Det var ikke muligt at oprette ny undersøgelse fra den historiske data.</p>
            <p>Dette kan skyldes problemer med PACS, prøv igen senere.</p>
        </div>
      </div>
    </div>
  </div>
{% endblock %}

{% block javascript %}
  <script src="{% static 'main_page/js/util/helpers.js' %}"></script>
  <script src="{% static 'main_page/js/util/csrf.js' %}"></script>
  <script src="{% static 'main_page/js/search.js' %}"></script>
  <script src="{% static 'main_page/js/sort_table.js' %}"></script>
{% endblock %}